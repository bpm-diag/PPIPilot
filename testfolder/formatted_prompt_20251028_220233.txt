You are an expert in Process Performance Indicators (PPIs) and JSON correction. Your task is to analyze and correct JSON translations that have caused errors during PPI execution.

## Context:
- Original JSON: [
  {
    "PPIname": "Median time for 'Declaration SUBMITTED by EMPLOYEE' across all cases",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "median"
    }
  },
  {
    "PPIname": "Time variance of 'Declaration SUBMITTED by EMPLOYEE' across different organizational resources",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "variance",
      "group_by": "case:resource"
    }
  },
  {
    "PPIname": "Difference in average time from 'Declaration SUBMITTED by EMPLOYEE' to 'Declaration APPROVED by ADMINISTRATION' between the fastest and slowest variants",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "activity == 'Declaration APPROVED by ADMINISTRATION'",
      "aggregation": "difference",
      "filter": "variant == 'fastest' || variant == 'slowest'"
    }
  },
  {
    "PPIname": "Average time from 'Declaration SUBMITTED by EMPLOYEE' to the next activity in the process",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "average",
      "filter": "next_activity"
    }
  },
  {
    "PPIname": "Standard deviation of time for 'Declaration SUBMITTED by EMPLOYEE' across all process variants",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "standard deviation",
      "group_by": "variant"
    }
  },
  {
    "PPIname": "Comparison of average time from 'Declaration SUBMITTED by EMPLOYEE' to 'Declaration FINAL_APPROVED by SUPERVISOR' between cases with and without 'Declaration REJECTED by SUPERVISOR'",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "activity == 'Declaration FINAL_APPROVED by SUPERVISOR'",
      "aggregation": "comparison",
      "filter": "activity == 'Declaration REJECTED by SUPERVISOR'"
    }
  },
  {
    "PPIname": "Median resolution time of 'Declaration SUBMITTED by EMPLOYEE' for cases ending with 'Payment Handled'",
    "PPIjson": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "activity == 'Payment Handled'",
      "aggregation": "median"
    }
  },
  {
    "PPIname": "Average time from 'Declaration SAVED by EMPLOYEE' to the next activity in the process, excluding rejections",
    "PPIjson": {
      "begin": "activity == 'Declaration SAVED by EMPLOYEE'",
      "end": "",
      "aggregation": "average",
      "filter": "activity != 'Declaration REJECTED by EMPLOYEE' and activity != 'Declaration REJECTED by ADMINISTRATION' and activity != 'Declaration REJECTED by SUPERVISOR' and activity != 'Declaration REJECTED by MISSING' and activity != 'Declaration REJECTED by PRE_APPROVER' and activity != 'Declaration REJECTED by BUDGET OWNER'"
    }
  },
  {
    "PPIname": "Minimum time for 'Request Payment' across different case amounts",
    "PPIjson": {
      "begin": "activity == 'Request Payment'",
      "end": "",
      "aggregation": "minimum",
      "group_by": "case:amount"
    }
  }
]
- Execution Errors: [
  {
    "ppi_name": "Median time for 'Declaration SUBMITTED by EMPLOYEE' across all cases",
    "error_type": "metric_computation",
    "error_message": "ERROR: A value in the measure wasn't correctly defined",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "median"
    }
  },
  {
    "ppi_name": "Time variance of 'Declaration SUBMITTED by EMPLOYEE' across different organizational resources",
    "error_type": "metric_computation",
    "error_message": "'Column not found: case:resource'",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "variance",
      "group_by": "case:resource"
    }
  },
  {
    "ppi_name": "Difference in average time from 'Declaration SUBMITTED by EMPLOYEE' to 'Declaration APPROVED by ADMINISTRATION' between the fastest and slowest variants",
    "error_type": "metric_computation",
    "error_message": "ERROR: A value in the measure wasn't correctly defined",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "activity == 'Declaration APPROVED by ADMINISTRATION'",
      "aggregation": "difference",
      "filter": "variant == 'fastest' || variant == 'slowest'"
    }
  },
  {
    "ppi_name": "Average time from 'Declaration SUBMITTED by EMPLOYEE' to the next activity in the process",
    "error_type": "metric_resolution",
    "error_message": "cannot unpack non-iterable NoneType object",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "average",
      "filter": "next_activity"
    }
  },
  {
    "ppi_name": "Standard deviation of time for 'Declaration SUBMITTED by EMPLOYEE' across all process variants",
    "error_type": "metric_computation",
    "error_message": "'Column not found: variant'",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "",
      "aggregation": "standard deviation",
      "group_by": "variant"
    }
  },
  {
    "ppi_name": "Comparison of average time from 'Declaration SUBMITTED by EMPLOYEE' to 'Declaration FINAL_APPROVED by SUPERVISOR' between cases with and without 'Declaration REJECTED by SUPERVISOR'",
    "error_type": "metric_computation",
    "error_message": "ERROR: A value in the measure wasn't correctly defined",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "activity == 'Declaration FINAL_APPROVED by SUPERVISOR'",
      "aggregation": "comparison",
      "filter": "activity == 'Declaration REJECTED by SUPERVISOR'"
    }
  },
  {
    "ppi_name": "Median resolution time of 'Declaration SUBMITTED by EMPLOYEE' for cases ending with 'Payment Handled'",
    "error_type": "metric_computation",
    "error_message": "ERROR: A value in the measure wasn't correctly defined",
    "ppi_json": {
      "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
      "end": "activity == 'Payment Handled'",
      "aggregation": "median"
    }
  },
  {
    "ppi_name": "Average time from 'Declaration SAVED by EMPLOYEE' to the next activity in the process, excluding rejections",
    "error_type": "metric_computation",
    "error_message": "name 'activity' is not defined",
    "ppi_json": {
      "begin": "activity == 'Declaration SAVED by EMPLOYEE'",
      "end": "",
      "aggregation": "average",
      "filter": "activity != 'Declaration REJECTED by EMPLOYEE' and activity != 'Declaration REJECTED by ADMINISTRATION' and activity != 'Declaration REJECTED by SUPERVISOR' and activity != 'Declaration REJECTED by MISSING' and activity != 'Declaration REJECTED by PRE_APPROVER' and activity != 'Declaration REJECTED by BUDGET OWNER'"
    }
  },
  {
    "ppi_name": "Minimum time for 'Request Payment' across different case amounts",
    "error_type": "metric_computation",
    "error_message": "'Column not found: case:amount'",
    "ppi_json": {
      "begin": "activity == 'Request Payment'",
      "end": "",
      "aggregation": "minimum",
      "group_by": "case:amount"
    }
  }
]
- Log Activities: Declaration SUBMITTED by EMPLOYEE, Declaration FINAL_APPROVED by SUPERVISOR, Payment Handled, Request Payment, Declaration APPROVED by ADMINISTRATION, Declaration APPROVED by BUDGET OWNER, Declaration REJECTED by EMPLOYEE, Declaration REJECTED by ADMINISTRATION, Declaration APPROVED by PRE_APPROVER, Declaration REJECTED by SUPERVISOR, Declaration SAVED by EMPLOYEE, Declaration REJECTED by MISSING, Declaration REJECTED by PRE_APPROVER, Declaration REJECTED by BUDGET OWNER, Declaration FOR_APPROVAL by SUPERVISOR, Declaration FOR_APPROVAL by PRE_APPROVER, Declaration FOR_APPROVAL by ADMINISTRATION
- Log Attributes: No attributes provided

## Your Task:
Fix the JSON by solving the problems identified in the error messages

**CRITICAL REQUIREMENTS:**
- REMOVE any `group_by` parameter that references a column that doesn't exist
- REMOVE any `filter` parameter that contains AND/OR conditions or references undefined variables
- REMOVE any parameter that references columns not available in the log attributes
- REMOVE any `metric_condition` parameter - this field is NOT valid for time-based PPIs
- **REPLACE any invalid aggregation value** (like "variance", "sum", "count") with "average"
- Only use activity names that exist in the provided log activities list
- Only use attribute names that exist in the provided log attributes list
- PRESERVE the original PPI JSON structures - only REMOVE or FIX problematic parameters
- Do NOT change activity names unless they don't exist in the log
- Each PPI should maintain its unique structure and purpose
- **COMPLETELY REMOVE filter fields that contain AND/OR conditions or undefined variables**
- **Simple filters are allowed ONLY if they reference a single, valid condition without AND/OR operators**
- **aggregation MUST be one of: "total", "minimum", "maximum", "average" - NO OTHER VALUES ALLOWED**

## Focus Areas:

1. **Syntax Issues**: Fix any JSON formatting problems, missing quotes, brackets, or commas
2. **Field Validation**: Ensure all required fields are present and correctly formatted
3. **Activity Names**: Verify activity names match those available in the log
4. **Attribute Names**: Ensure attribute references are valid and exist in the log
5. **Logical Expressions**: REMOVE complex filter conditions with AND/OR operators
6. **Variable References**: REMOVE parameters that reference undefined variables
7. **Data Types**: Ensure values have correct data types (strings, numbers, booleans)

## Common Error Patterns to Fix:
- Missing or incorrect quotes around strings
- Invalid activity names that don't exist in the provided log activities
- **Complex filter expressions with AND/OR operators - REMOVE these entirely**
- **Undefined variable references - REMOVE the entire parameter field**
- **Non-existent column references - REMOVE the parameter line**
- **Invalid aggregation values like "variance", "sum", "count" - REPLACE with "average"**
- **metric_condition in time-based PPIs - REMOVE this field entirely (only valid for count PPIs)**
- Incorrect aggregation functions (use only: average, total, minimum, maximum)
- Missing required fields like "count", "begin", "end"
- Incorrect group_by or filter syntax referencing non-existent columns
- Empty begin/end fields should have proper activity references or be removed
- Escaped quotes (\\) should be removed

## GENERAL ERROR FIXING RULES:

Based on any errors provided, you MUST apply these general rules:

1. **For any "Column not found" errors:**
   - ERROR PATTERN: 'Column not found: [column_name]' or 'KeyError: [column_name]'
   - FIX: Remove the entire line that references the non-existent column (e.g., `"group_by": "[column_name]"`, `"filter": "[condition with column_name]"`)

2. **For any "name '[variable]' is not defined" errors:**
   - ERROR PATTERN: "name '[variable_name]' is not defined"
   - FIX: Remove the entire parameter that uses the undefined variable (e.g., remove `"filter"` field if it references undefined variables)

3. **For any invalid attribute/column references:**
   - ERROR PATTERN: References to columns not in the available attributes list
   - FIX: Remove the entire parameter line that references the invalid attribute

4. **For any AND/OR logical operator errors:**
   - ERROR PATTERN: Complex filter conditions with AND/OR that cause parsing errors
   - FIX: Remove the entire `"filter"` field to avoid logical operator issues

5. **For any syntax or parsing errors:**
   - ERROR PATTERN: JSON formatting issues, malformed expressions
   - FIX: Correct the syntax while maintaining the original structure and intent

6. **For any aggregation function errors:**
   - ERROR PATTERN: Invalid aggregation methods
   - FIX: Use only valid aggregation functions: average, total, minimum, maximum

## Output Format:
Return ONLY the corrected JSON array in the exact same structure as the input, with all errors fixed. Do not include any explanations, markdown formatting, or additional text.

**CRITICAL OUTPUT REQUIREMENTS:**
- Start your response immediately with the opening bracket `[`
- End your response with the closing bracket `]`
- Use proper JSON formatting with double quotes for all strings
- Do not include any text before or after the JSON
- Do not wrap the JSON in markdown code blocks
- **REMOVE entire parameter fields when they contain errors rather than trying to fix complex conditions**
- Maintain proper JSON structure and indentation

## CORRECTION EXAMPLES:

**Example 1 - Removing undefined variable filter:**
BEFORE (with error):
```json
{
  "PPIname": "Average time from activity A to next activity",
  "PPIjson": {
    "begin": "activity == 'Activity A'",
    "end": "",
    "aggregation": "average",
    "filter": "activity != 'Rejected Activity' and activity != 'Failed Activity'"
  }
}
```

AFTER (corrected):
```json
{
  "PPIname": "Average time from activity A to next activity",
  "PPIjson": {
    "begin": "activity == 'Activity A'",
    "end": "",
    "aggregation": "average"
  }
}
```

**Example 2 - Removing non-existent column reference:**
BEFORE (with error):
```json
{
  "PPIname": "Count by resource type",
  "PPIjson": {
    "count": "case:id",
    "aggregation": "total",
    "group_by": "case:resource"
  }
}
```

AFTER (corrected):
```json
{
  "PPIname": "Count by resource type",
  "PPIjson": {
    "count": "case:id",
    "aggregation": "total"
  }
}
```

**Example 3 - Fixing invalid aggregation and removing metric_condition:**
BEFORE (with error):
```json
{
  "PPIname": "Time variance for Declaration SUBMITTED",
  "PPIjson": {
    "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
    "end": "",
    "aggregation": "variance",
    "metric_condition": "> average_time"
  }
}
```

AFTER (corrected):
```json
{
  "PPIname": "Time variance for Declaration SUBMITTED",
  "PPIjson": {
    "begin": "activity == 'Declaration SUBMITTED by EMPLOYEE'",
    "end": "",
    "aggregation": "average"
  }
}
```

## Complete Template Structures:

**COMPLETE structure for time-based PPIs (all possible fields):**
```json
{
    "PPIname": "[write the PPI name]",
    "PPIjson": {
        "begin": "[write the begin field]",
        "end": "[write the end field]",
        "aggregation": "[write the aggregation field]",
        "filter": "[write the filter field]",
        "group_by": "[write the group_by field]"
    }
}
```

**COMPLETE structure for count/occurrence PPIs (all possible fields):**
```json
{
    "PPIname": "[write the PPI name]",
    "PPIjson": {
        "count": "[write the count field]",
        "metric_condition": "[write the metric_condition field]",
        "aggregation": "[write the aggregation field]",
        "filter": "[write the filter field]",
        "group_by": "[write the group_by field]"
    }
}
```

**IMPORTANT NOTES:**
- `filter` and `group_by` are OPTIONAL fields
- ONLY include `filter` if it's a simple, valid condition without AND/OR operators
- ONLY include `group_by` if the column exists in the log attributes
- `aggregation` can ONLY be one of these values: "total", "minimum", "maximum", "average" (no other values like "variance", "sum", etc.)
- When in doubt, REMOVE the problematic parameter entirely rather than attempting to fix complex logical conditions or non-existent references
- All fields should be strings (enclosed in double quotes)

**REMEMBER: When in doubt, REMOVE the problematic parameter entirely rather than attempting to fix complex logical conditions or non-existent references.**
